(this["webpackJsonpmachine-music"]=this["webpackJsonpmachine-music"]||[]).push([[0],{104:function(e,t){},105:function(e,t){},106:function(e,t){},107:function(e,t){},108:function(e,t){},109:function(e,t){},110:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(22),c=n.n(o),i=(n(71),n(18));n(72),n(73),n(74);function l(){return r.a.createElement("div",{className:"titlecard"},r.a.createElement("h1",{className:"title"},"MACHINE"),r.a.createElement("h2",{className:"subtitle"},"Procedurally generated music, powered by machine learning"))}var s=n(131),u=n(141),h=n(135);n(75);function m(e){return r.a.createElement("div",null,r.a.createElement(s.a,{square:!0},r.a.createElement(u.a,{value:e.view,indicatorColor:"primary",textColor:"primary",onChange:function(t,n){e.updateView(n)},"aria-label":"nav tabs",centered:!0},r.a.createElement(h.a,{label:"Generate"}),r.a.createElement(h.a,{label:"Generate 2",disabled:!0}),r.a.createElement(h.a,{label:"About"}))))}var f=n(138),p=n(139),d=n(24),v=n.n(d);function y(e,t){var n=[],a=[];e.notes.forEach((function(e){return n.push(e.pitch)})),t.notes.forEach((function(e){return a.push(e.pitch)}));for(var r=Array(a.length+1).fill(null).map((function(){return Array(a.length+1).fill(null)})),o=0;o<=n.length;o+=1)r[0][o]=o;for(var c=0;c<=a.length;c+=1)r[c][0]=c;for(var i=1;i<=a.length;i+=1)for(var l=1;l<=n.length;l+=1){var s=n[l-1]===a[i-1]?0:1;r[i][l]=Math.min(r[i][l-1]+1,r[i-1][l]+1,r[i-1][l-1]+s)}return r[a.length][n.length]}function g(e,t){var n=[],a=[];e.notes.forEach((function(e){return n.push(e.quantizedStartStep)})),t.notes.forEach((function(e){return a.push(e.quantizedStartStep)}));for(var r=Array(a.length+1).fill(null).map((function(){return Array(a.length+1).fill(null)})),o=0;o<=n.length;o+=1)r[0][o]=o;for(var c=0;c<=a.length;c+=1)r[c][0]=c;for(var i=1;i<=a.length;i+=1)for(var l=1;l<=n.length;l+=1){var s=n[l-1]===a[i-1]?0:1;r[i][l]=Math.min(r[i][l-1]+1,r[i-1][l]+1,r[i-1][l-1]+s)}return r[a.length][n.length]}function E(e,t){return 1-Math.max(Math.min(e,t))}var b=n(51),w=n(52),S=n(58),j=n(53),O=n(59),N=n(26),P=n(17),M=function(e){function t(){var e;return Object(b.a)(this,t),(e=Object(S.a)(this,Object(j.a)(t).call(this))).bassSynth=new P.Synth({volume:8,oscillator:{type:"sine"},envelope:{attack:.2,decay:.4,sustain:.4,release:.6}}).toMaster(),e.autopanner=new P.AutoPanner({frequency:.5,type:"sine",depth:1}).toMaster().start(),e.reverb=new P.Reverb({decay:3,wet:1}).toMaster(),e.AutoFilter=(new P.AutoFilter).toMaster().start(),e.polySynth=new P.Synth({volume:5,oscillator:{type:"sine"},envelope:{attack:10,decay:.8,sustain:1,release:4}}).connect(e.reverb).connect(e.autopanner).connect(e.AutoFilter).toMaster(),e.tone=P,e}return Object(O.a)(t,e),Object(w.a)(t,[{key:"playNote",value:function(e,t){var n=t.hasOwnProperty("velocity")?t.velocity/127:void 0;if(t.isDrum)this.drumKit.playNote(t.pitch,e,n);else{var a=new P.Frequency(t.pitch,"midi"),r=t.endTime-t.startTime;this.getSynth(t.instrument,t.program).triggerAttackRelease(a,r,e,n)}}},{key:"getSynth",value:function(e,t){return void 0!==t&&t>=32&&t<=39?this.bassSynth:this.polySynth}}]),t}(N.BasePlayer),k=n(26),A=new M,q=new k.MusicRNN("https://storage.googleapis.com/magentadata/js/checkpoints/music_rnn/basic_rnn"),z=[],C=[],x=1,I=1,F=-2;function R(e){e(!0);var t=_(),n=_(),a=_();Promise.all([t,n,a]).then((function(t){v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:z.push(t[0],t[1],t[0],t[1]),z.push(t[0],t[2],t[0],t[2]),z.push(t[0],t[1],t[0],t[1]),z.push(t[0],t[2],t[0],t[2]),e(!1);case 5:case"end":return n.stop()}})).then((function(){console.log(z),A.start(z[0]).then((function(){!function e(t){1===x&&(1===t&&B(2),A.start(z[t]).then((function(){(I=(t+1)%16)%16===1?(x=2,e(I)):e(I)})));2===x&&(1===t&&B(1),A.start(C[t]).then((function(){(I=(t+1)%16)%16===1?(x=1,e(I)):e(I)})))}(I)}))}))}))}function _(){var e={quantizationInfo:{stepsPerQuarter:4},notes:[],totalQuantizedSteps:1};return new Promise((function(t,n){try{q.continueSequence(e,31,.6).then((function(n){n.notes.forEach((function(t){t.quantizedStartStep+=1,t.quantizedEndStep+=1,e.notes.push(t)})),t(e)}))}catch(a){n(console.log("Creation of melody failed."))}}))}function B(e){if(2===e){var t,n,a,r,o,c;C=[],function e(){r=_(),o=_(),c=_(),Promise.all([r,o,c]).then((function(r){t=E(y(r[0],z[0]),g(r[0],z[0])),n=E(y(r[1],z[1]),g(r[1],z[1])),a=E(y(r[2],z[2]),g(r[2],z[2])),t>F&&n>F&&a>F?(C.push(r[0],r[1],r[0],r[1]),C.push(r[0],r[2],r[0],r[2]),C.push(r[0],r[1],r[0],r[1]),C.push(r[0],r[2],r[0],r[2]),console.log(C)):(console.log("unfit scores = "+t+" "+n+" "+a),e())}))}()}if(1===e){z=[],function e(){var t=_(),n=_(),a=_();Promise.all([t,n,a]).then((function(t){var n=E(y(t[0],C[0]),g(t[0],C[0])),a=E(y(t[1],C[1]),g(t[1],C[1])),r=E(y(t[2],C[2]),g(t[2],C[2]));n>F&&a>F&&r>F?(z.push(t[0],t[1],t[0],t[1]),z.push(t[0],t[2],t[0],t[2]),z.push(t[0],t[1],t[0],t[1]),z.push(t[0],t[2],t[0],t[2]),console.log(z)):(console.log("unfit scores = "+n+" "+a+" "+r),e())}))}()}}var G=n(26),Q=new M,W=new G.MusicRNN("https://storage.googleapis.com/magentadata/js/checkpoints/music_rnn/basic_rnn"),H=[],J=[],T=1,V=1;function D(e){e(!0);var t=K(),n=K(),a=K();Promise.all([t,n,a]).then((function(t){v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:H.push(t[0],t[1],t[0],t[1]),H.push(t[0],t[2],t[0],t[2]),H.push(t[0],t[1],t[0],t[1]),H.push(t[0],t[2],t[0],t[2]),e(!1);case 5:case"end":return n.stop()}})).then((function(){console.log(H),Q.start(H[0]).then((function(){!function e(t){1===T&&(1===t&&U(2),Q.start(H[t]).then((function(){(V=(t+1)%16)%16===1?(T=2,e(V)):e(V)})));2===T&&(1===t&&U(1),Q.start(J[t]).then((function(){(V=(t+1)%16)%16===1?(T=1,e(V)):e(V)})))}(V)}))}))}))}function K(){var e={quantizationInfo:{stepsPerQuarter:4},notes:[],totalQuantizedSteps:1};return new Promise((function(t,n){try{W.continueSequence(e,31,.6).then((function(n){n.notes.forEach((function(t){t.quantizedStartStep+=1,t.quantizedEndStep+=1,e.notes.push(t)})),t(e)}))}catch(a){n(console.log("Creation of melody failed."))}}))}function U(e){if(2===e){var t,n,a;J=[],t=K(),n=K(),a=K(),Promise.all([t,n,a]).then((function(e){J.push(e[0],e[1],e[0],e[1]),J.push(e[0],e[2],e[0],e[2]),J.push(e[0],e[1],e[0],e[1]),J.push(e[0],e[2],e[0],e[2]),console.log(J)}))}if(1===e){H=[],function(){var e=K(),t=K(),n=K();Promise.all([e,t,n]).then((function(e){H.push(e[0],e[1],e[0],e[1]),H.push(e[0],e[2],e[0],e[2]),H.push(e[0],e[1],e[0],e[1]),H.push(e[0],e[2],e[0],e[2]),console.log(H)}))}()}}n(110);var $=n(136),L=n(54),X=n.n(L);var Y=function(){return r.a.createElement($.a,{color:"primary","aria-label":"play"},r.a.createElement(X.a,null))},Z=n(55),ee=n.n(Z);var te=function(){return r.a.createElement($.a,{color:"primary","aria-label":"pause"},r.a.createElement(ee.a,null))};var ne=function(e){return!1===e.state?r.a.createElement(Y,null):r.a.createElement(te,null)},ae=n(137);function re(e){return!0===e.loading?r.a.createElement(ae.a,{color:"primary"}):null}var oe=function(e){function t(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(60),l=Object(i.a)(c,2),s=(l[0],l[1],Object(a.useState)(!1)),u=Object(i.a)(s,2),h=u[0],m=u[1];return r.a.createElement("div",{className:"play-controller-wrapper",onClick:function(){W.dispose(),Q.stop(),H=[],J=[],!0===h&&(m(!1),A.pause()),!1===h&&(m(!0),!1===A.isPlaying()&&R(o),A.resume())}},r.a.createElement(ne,{state:h}),r.a.createElement(re,{loading:n}))}switch(e.view){case 0:return r.a.createElement(t,null);case 1:return r.a.createElement((function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),l=Object(i.a)(c,2),s=l[0],u=l[1];return r.a.createElement("div",null,r.a.createElement(f.a,{variant:"h1",component:"h1"},"Generate 2"),r.a.createElement("div",{className:"play-controller-wrapper",onClick:function(){q.dispose(),A.stop(),z=[],C=[],!0===s&&(u(!1),Q.pause()),!1===s&&(u(!0),!1===Q.isPlaying()&&D(o),Q.resume())}},r.a.createElement(ne,{state:s})),r.a.createElement(re,{loading:n}))}),null);case 2:return r.a.createElement((function(){return r.a.createElement("div",{className:"main"},r.a.createElement(p.a,{maxWidth:"sm"},r.a.createElement(s.a,{className:"About",elevation:"5"},r.a.createElement(f.a,{variant:"h5",component:"h5"},"Machine music was made by Andrew Richardson as a sumbission for my final year project. It uses Google's Magenta.js to produce a melody, which is then evaluated by a custom fitness function and then rejected or used based on similarity."))))}),null);default:return r.a.createElement(t,null)}},ce=n(57),ie=n(56),le=n.n(ie),se=n(140);var ue=function(){var e=Object(a.useState)(0),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),s=Object(i.a)(c,2),u=s[0],h=s[1],f=Object(ce.a)({pallete:{primary:{main:se.a[600]},secondary:{main:se.a[100]}}}),p="end title";return p=1==u?"end title rainbow":"end title",r.a.createElement(le.a,{theme:f},r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"Header"},r.a.createElement(l,null)),r.a.createElement("div",{className:"Body"},r.a.createElement(m,{view:n,updateView:o}),r.a.createElement(oe,{view:n,updateColor:h})),r.a.createElement("div",{className:"Footer"},r.a.createElement("h1",{className:p},"MUSIC"),r.a.createElement("a",{href:"https://github.com/andrewsrichardson/",target:"_blank"},"made by andrewsrichardson"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},66:function(e,t,n){e.exports=n(112)},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},75:function(e,t,n){}},[[66,1,2]]]);
//# sourceMappingURL=main.122725b6.chunk.js.map