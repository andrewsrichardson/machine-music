(this["webpackJsonpmachine-music"]=this["webpackJsonpmachine-music"]||[]).push([[0],{107:function(e,t){},108:function(e,t){},109:function(e,t){},110:function(e,t){},111:function(e,t){},112:function(e,t){},113:function(e,t,n){},115:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(9),c=n.n(o),l=(n(76),n(23)),i=(n(77),n(78),n(150)),u=n(142),s=n(143);function h(){return r.a.createElement(i.a,null,r.a.createElement(u.a,null,r.a.createElement("div",{className:"title"},r.a.createElement(s.a,{variant:"h1",component:"h1"},"Machine Music")),r.a.createElement("div",{className:"subtitle"},r.a.createElement(s.a,{variant:"h4",component:"h4"},"Procedurally generated music, powered by machine learning"))))}var m=n(152),f=n(144);function p(e){return r.a.createElement("div",null,r.a.createElement(u.a,{square:!0},r.a.createElement(m.a,{value:e.view,indicatorColor:"primary",textColor:"primary",onChange:function(t,n){e.updateView(n)},"aria-label":"nav tabs",centered:!0},r.a.createElement(f.a,{label:"Generate 1"}),r.a.createElement(f.a,{label:"Generate 2"}),r.a.createElement(f.a,{label:"About"}))))}var v=n(147),d=n(153),E=n(151),y=n(154),g=n(148),b=n(33),w=n.n(b);function S(e,t){var n=[],a=[];e.notes.forEach((function(e){return n.push(e.pitch)})),t.notes.forEach((function(e){return a.push(e.pitch)}));for(var r=Array(a.length+1).fill(null).map((function(){return Array(a.length+1).fill(null)})),o=0;o<=n.length;o+=1)r[0][o]=o;for(var c=0;c<=a.length;c+=1)r[c][0]=c;for(var l=1;l<=a.length;l+=1)for(var i=1;i<=n.length;i+=1){var u=n[i-1]===a[l-1]?0:1;r[l][i]=Math.min(r[l][i-1]+1,r[l-1][i]+1,r[l-1][i-1]+u)}return r[a.length][n.length]}function j(e,t){var n=[],a=[];e.notes.forEach((function(e){return n.push(e.quantizedStartStep)})),t.notes.forEach((function(e){return a.push(e.quantizedStartStep)}));for(var r=Array(a.length+1).fill(null).map((function(){return Array(a.length+1).fill(null)})),o=0;o<=n.length;o+=1)r[0][o]=o;for(var c=0;c<=a.length;c+=1)r[c][0]=c;for(var l=1;l<=a.length;l+=1)for(var i=1;i<=n.length;i+=1){var u=n[i-1]===a[l-1]?0:1;r[l][i]=Math.min(r[l][i-1]+1,r[l-1][i]+1,r[l-1][i-1]+u)}return r[a.length][n.length]}function O(e,t){return 1-Math.max(Math.min(e,t))}var P=n(57),N=n(58),M=n(63),k=n(59),q=n(64),A=n(36),z=n(21),C=function(e){function t(){var e;return Object(P.a)(this,t),(e=Object(M.a)(this,Object(k.a)(t).call(this))).bassSynth=new z.Synth({volume:8,oscillator:{type:"sine"},envelope:{attack:.2,decay:.4,sustain:.4,release:.6}}).toMaster(),e.autopanner=new z.AutoPanner({frequency:.5,type:"sine",depth:1}).toMaster().start(),e.reverb=new z.Reverb({decay:3,wet:1}).toMaster(),e.AutoFilter=(new z.AutoFilter).toMaster().start(),e.polySynth=new z.Synth({volume:5,oscillator:{type:"sine"},envelope:{attack:10,decay:.8,sustain:1,release:4}}).connect(e.reverb).connect(e.autopanner).connect(e.AutoFilter).toMaster(),e.tone=z,e}return Object(q.a)(t,e),Object(N.a)(t,[{key:"playNote",value:function(e,t){var n=t.hasOwnProperty("velocity")?t.velocity/127:void 0;if(t.isDrum)this.drumKit.playNote(t.pitch,e,n);else{var a=new z.Frequency(t.pitch,"midi"),r=t.endTime-t.startTime;this.getSynth(t.instrument,t.program).triggerAttackRelease(a,r,e,n)}}},{key:"getSynth",value:function(e,t){return void 0!==t&&t>=32&&t<=39?this.bassSynth:this.polySynth}}]),t}(A.BasePlayer),x=n(36),F=new C,R=new x.MusicRNN("https://storage.googleapis.com/magentadata/js/checkpoints/music_rnn/basic_rnn"),B=[],G=[],Q=1,_=1,I=-2;function T(e){e(!0);var t=W(),n=W(),a=W();Promise.all([t,n,a]).then((function(t){w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:B.push(t[0],t[1],t[0],t[1]),B.push(t[0],t[2],t[0],t[2]),B.push(t[0],t[1],t[0],t[1]),B.push(t[0],t[2],t[0],t[2]),e(!1);case 5:case"end":return n.stop()}})).then((function(){console.log(B),F.start(B[0]).then((function(){!function e(t){1===Q&&(1===t&&J(2),F.start(B[t]).then((function(){(_=(t+1)%16)%16===1?(Q=2,e(_)):e(_)})));2===Q&&(1===t&&J(1),F.start(G[t]).then((function(){(_=(t+1)%16)%16===1?(Q=1,e(_)):e(_)})))}(_)}))}))}))}function W(){var e={quantizationInfo:{stepsPerQuarter:4},notes:[],totalQuantizedSteps:1};return new Promise((function(t,n){try{R.continueSequence(e,31,.6).then((function(n){n.notes.forEach((function(t){t.quantizedStartStep+=1,t.quantizedEndStep+=1,e.notes.push(t)})),t(e)}))}catch(a){n(console.log("Creation of melody failed."))}}))}function J(e){if(2===e){var t,n,a,r,o,c;G=[],function e(){r=W(),o=W(),c=W(),Promise.all([r,o,c]).then((function(r){t=O(S(r[0],B[0]),j(r[0],B[0])),n=O(S(r[1],B[1]),j(r[1],B[1])),a=O(S(r[2],B[2]),j(r[2],B[2])),t>I&&n>I&&a>I?(G.push(r[0],r[1],r[0],r[1]),G.push(r[0],r[2],r[0],r[2]),G.push(r[0],r[1],r[0],r[1]),G.push(r[0],r[2],r[0],r[2]),console.log(G)):(console.log("unfit scores = "+t+" "+n+" "+a),e())}))}()}if(1===e){B=[],function e(){var t=W(),n=W(),a=W();Promise.all([t,n,a]).then((function(t){var n=O(S(t[0],G[0]),j(t[0],G[0])),a=O(S(t[1],G[1]),j(t[1],G[1])),r=O(S(t[2],G[2]),j(t[2],G[2]));n>I&&a>I&&r>I?(B.push(t[0],t[1],t[0],t[1]),B.push(t[0],t[2],t[0],t[2]),B.push(t[0],t[1],t[0],t[1]),B.push(t[0],t[2],t[0],t[2]),console.log(B)):(console.log("unfit scores = "+n+" "+a+" "+r),e())}))}()}}var V=n(36),D=new C,H=new V.MusicRNN("https://storage.googleapis.com/magentadata/js/checkpoints/music_rnn/basic_rnn"),K=[],$=[],L=1,U=1;function X(e){e(!0);var t=Y(),n=Y(),a=Y();Promise.all([t,n,a]).then((function(t){w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:K.push(t[0],t[1],t[0],t[1]),K.push(t[0],t[2],t[0],t[2]),K.push(t[0],t[1],t[0],t[1]),K.push(t[0],t[2],t[0],t[2]),e(!1);case 5:case"end":return n.stop()}})).then((function(){console.log(K),D.start(K[0]).then((function(){!function e(t){1===L&&(1===t&&Z(2),D.start(K[t]).then((function(){(U=(t+1)%16)%16===1?(L=2,e(U)):e(U)})));2===L&&(1===t&&Z(1),D.start($[t]).then((function(){(U=(t+1)%16)%16===1?(L=1,e(U)):e(U)})))}(U)}))}))}))}function Y(){var e={quantizationInfo:{stepsPerQuarter:4},notes:[],totalQuantizedSteps:1};return new Promise((function(t,n){try{H.continueSequence(e,31,.6).then((function(n){n.notes.forEach((function(t){t.quantizedStartStep+=1,t.quantizedEndStep+=1,e.notes.push(t)})),t(e)}))}catch(a){n(console.log("Creation of melody failed."))}}))}function Z(e){if(2===e){var t,n,a;$=[],t=Y(),n=Y(),a=Y(),Promise.all([t,n,a]).then((function(e){$.push(e[0],e[1],e[0],e[1]),$.push(e[0],e[2],e[0],e[2]),$.push(e[0],e[1],e[0],e[1]),$.push(e[0],e[2],e[0],e[2]),console.log($)}))}if(1===e){K=[],function(){var e=Y(),t=Y(),n=Y();Promise.all([e,t,n]).then((function(e){K.push(e[0],e[1],e[0],e[1]),K.push(e[0],e[2],e[0],e[2]),K.push(e[0],e[1],e[0],e[1]),K.push(e[0],e[2],e[0],e[2]),console.log(K)}))}()}}n(113);var ee=n(145),te=n(60),ne=n.n(te);var ae=function(){return r.a.createElement(ee.a,{color:"primary","aria-label":"play"},r.a.createElement(ne.a,null))},re=n(61),oe=n.n(re);var ce=function(){return r.a.createElement(ee.a,{color:"primary","aria-label":"pause"},r.a.createElement(oe.a,null))};var le=function(e){return!1===e.state?r.a.createElement(ae,null):r.a.createElement(ce,null)},ie=n(146);function ue(e){return!0===e.loading?r.a.createElement(ie.a,{color:"primary"}):null}function se(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(60),i=Object(l.a)(c,2),u=i[0],h=i[1],m=Object(a.useState)(!1),f=Object(l.a)(m,2),p=f[0],g=f[1];return r.a.createElement("div",null,r.a.createElement(s.a,{variant:"h1",component:"h1"},"Generate 1"),r.a.createElement(v.a,null,r.a.createElement(d.a,{id:"label",value:"60"},"Tempo"),r.a.createElement(E.a,{labelid:"label",value:u,onChange:function(e){h(e.target.value),function(e){e}(u)},inputProps:{tempo:"tempo"}},r.a.createElement(y.a,{value:60},"60"),r.a.createElement(y.a,{value:80},"80"),r.a.createElement(y.a,{value:100},"100"),r.a.createElement(y.a,{value:120},"120"))),r.a.createElement("div",{className:"play-controller-wrapper",onClick:function(){H.dispose(),D.stop(),K=[],$=[],!0===p&&(g(!1),F.pause()),!1===p&&(g(!0),!1===F.isPlaying()&&T(o),F.resume())}},r.a.createElement(le,{state:p})),r.a.createElement(ue,{loading:n}))}function he(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),i=Object(l.a)(c,2),u=i[0],h=i[1];return r.a.createElement("div",null,r.a.createElement(s.a,{variant:"h1",component:"h1"},"Generate 2"),r.a.createElement("div",{className:"play-controller-wrapper",onClick:function(){R.dispose(),F.stop(),B=[],G=[],!0===u&&(h(!1),D.pause()),!1===u&&(h(!0),!1===D.isPlaying()&&X(o),D.resume())}},r.a.createElement(le,{state:u})),r.a.createElement(ue,{loading:n}))}function me(){return r.a.createElement("div",{className:"main"},r.a.createElement(g.a,{maxWidth:"sm"},r.a.createElement(u.a,{className:"About",elevation:"5"},r.a.createElement(s.a,{variant:"h5",component:"h5"},"Machine music was made by Andrew Richardson as a sumbission for my final year project."))))}function fe(e){switch(e.view){case 0:return r.a.createElement(se,null);case 1:return r.a.createElement(he,null);case 2:return r.a.createElement(me,null);default:return r.a.createElement(se,null)}}var pe=function(){var e=Object(a.useState)(0),t=Object(l.a)(e,2),n=t[0],o=t[1];return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"Header"},r.a.createElement(h,null)),r.a.createElement("div",{className:"Body"},r.a.createElement(p,{view:n,updateView:o}),r.a.createElement(fe,{view:n})),r.a.createElement("div",{className:"Footer"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},71:function(e,t,n){e.exports=n(115)},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){}},[[71,1,2]]]);
//# sourceMappingURL=main.6ea678b6.chunk.js.map