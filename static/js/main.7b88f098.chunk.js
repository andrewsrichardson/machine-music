(this["webpackJsonpmachine-music"]=this["webpackJsonpmachine-music"]||[]).push([[0],{107:function(e,t){},108:function(e,t){},109:function(e,t){},110:function(e,t){},111:function(e,t){},112:function(e,t){},113:function(e,t,n){},115:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),l=n(9),c=n.n(l),o=(n(76),n(32)),i=(n(77),n(78),n(150)),u=n(142),s=n(143);function m(){return r.a.createElement(i.a,null,r.a.createElement(u.a,null,r.a.createElement("div",{className:"title"},r.a.createElement(s.a,{variant:"h1",component:"h1"},"Machine Music")),r.a.createElement("div",{className:"subtitle"},r.a.createElement(s.a,{variant:"h4",component:"h4"},"Procedurally generated music, powered by machine learning"))))}var h=n(152),f=n(144);function p(e){return r.a.createElement("div",null,r.a.createElement(u.a,{square:!0},r.a.createElement(h.a,{value:e.view,indicatorColor:"primary",textColor:"primary",onChange:function(t,n){e.updateView(n)},"aria-label":"nav tabs",centered:!0},r.a.createElement(f.a,{label:"Generate"}),r.a.createElement(f.a,{label:"Train",disabled:!0}),r.a.createElement(f.a,{label:"About",disabled:!0}))))}var v=n(147),d=n(153),E=n(151),y=n(154),g=n(148),b=n(47),w=n.n(b);function S(e,t){var n=[],a=[];e.notes.forEach((function(e){return n.push(e.pitch)})),t.notes.forEach((function(e){return a.push(e.pitch)}));for(var r=Array(a.length+1).fill(null).map((function(){return Array(a.length+1).fill(null)})),l=0;l<=n.length;l+=1)r[0][l]=l;for(var c=0;c<=a.length;c+=1)r[c][0]=c;for(var o=1;o<=a.length;o+=1)for(var i=1;i<=n.length;i+=1){var u=n[i-1]===a[o-1]?0:1;r[o][i]=Math.min(r[o][i-1]+1,r[o-1][i]+1,r[o-1][i-1]+u)}return r[a.length][n.length]}function j(e,t){var n=[],a=[];e.notes.forEach((function(e){return n.push(e.quantizedStartStep)})),t.notes.forEach((function(e){return a.push(e.quantizedStartStep)}));for(var r=Array(a.length+1).fill(null).map((function(){return Array(a.length+1).fill(null)})),l=0;l<=n.length;l+=1)r[0][l]=l;for(var c=0;c<=a.length;c+=1)r[c][0]=c;for(var o=1;o<=a.length;o+=1)for(var i=1;i<=n.length;i+=1){var u=n[i-1]===a[o-1]?0:1;r[o][i]=Math.min(r[o][i-1]+1,r[o-1][i]+1,r[o-1][i-1]+u)}return r[a.length][n.length]}function O(e,t){return 1-Math.max(Math.min(e,t))}var A=n(57),M=n(58),N=n(63),k=n(59),P=n(64),q=n(48),z=n(21),C=function(e){function t(){var e;return Object(A.a)(this,t),(e=Object(N.a)(this,Object(k.a)(t).call(this))).bassSynth=new z.Synth({volume:8,oscillator:{type:"sine"},envelope:{attack:.2,decay:.4,sustain:.4,release:.6}}).toMaster(),e.autopanner=new z.AutoPanner({frequency:.5,type:"sine",depth:1}).toMaster().start(),e.reverb=new z.Reverb({decay:3,wet:1}).toMaster(),e.AutoFilter=(new z.AutoFilter).toMaster().start(),e.polySynth=new z.Synth({volume:12,oscillator:{type:"sine"},envelope:{attack:10,decay:.8,sustain:1,release:4}}).connect(e.reverb).connect(e.autopanner).connect(e.AutoFilter).toMaster(),e.tone=z,e}return Object(P.a)(t,e),Object(M.a)(t,[{key:"playNote",value:function(e,t){var n=t.hasOwnProperty("velocity")?t.velocity/127:void 0;if(t.isDrum)this.drumKit.playNote(t.pitch,e,n);else{var a=new z.Frequency(t.pitch,"midi"),r=t.endTime-t.startTime;this.getSynth(t.instrument,t.program).triggerAttackRelease(a,r,e,n)}}},{key:"getSynth",value:function(e,t){return void 0!==t&&t>=32&&t<=39?this.bassSynth:this.polySynth}}]),t}(q.BasePlayer),x=n(48),F=new C,T=new x.MusicRNN("https://storage.googleapis.com/magentadata/js/checkpoints/music_rnn/basic_rnn"),B=[],R=[],W=1,G=1;function I(e){e(!0);var t=J(),n=J(),a=J();Promise.all([t,n,a]).then((function(t){w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:B.push(t[0],t[1],t[0],t[1]),B.push(t[0],t[2],t[0],t[2]),B.push(t[0],t[1],t[0],t[1]),B.push(t[0],t[2],t[0],t[2]),e(!1);case 5:case"end":return n.stop()}})).then((function(){console.log(B),F.start(B[0]).then((function(){!function e(t){1===W&&(1===t&&Q(2),F.start(B[t]).then((function(){(G=(t+1)%16)%16===1?(W=2,e(G)):e(G)})));2===W&&(1===t&&Q(1),F.start(R[t]).then((function(){(G=(t+1)%16)%16===1?(W=1,e(G)):e(G)})))}(G)}))}))}))}function J(){var e={quantizationInfo:{stepsPerQuarter:4},notes:[],totalQuantizedSteps:1};return new Promise((function(t,n){try{T.continueSequence(e,31,.5).then((function(n){n.notes.forEach((function(t){t.quantizedStartStep+=1,t.quantizedEndStep+=1,e.notes.push(t)})),t(e)}))}catch(a){n(console.log("Creation of melody failed."))}}))}function Q(e){if(2===e){var t,n,a,r,l,c;R=[],function e(){r=J(),l=J(),c=J(),Promise.all([r,l,c]).then((function(r){t=O(S(r[0],B[0]),j(r[0],B[0])),n=O(S(r[1],B[1]),j(r[1],B[1])),a=O(S(r[2],B[2]),j(r[2],B[2])),t>-5&&n>-5&&a>-5?(R.push(r[0],r[1],r[0],r[1]),R.push(r[0],r[2],r[0],r[2]),R.push(r[0],r[1],r[0],r[1]),R.push(r[0],r[2],r[0],r[2]),console.log(R)):(console.log("unfit scores = "+t+" "+n+" "+a),e())}))}()}if(1===e){B=[],function e(){var t=J(),n=J(),a=J();Promise.all([t,n,a]).then((function(t){var n=O(S(t[0],R[0]),j(t[0],R[0])),a=O(S(t[1],R[1]),j(t[1],R[1])),r=O(S(t[2],R[2]),j(t[2],R[2]));n>-5&&a>-5&&r>-5?(B.push(t[0],t[1],t[0],t[1]),B.push(t[0],t[2],t[0],t[2]),B.push(t[0],t[1],t[0],t[1]),B.push(t[0],t[2],t[0],t[2]),console.log(B)):(console.log("unfit scores = "+n+" "+a+" "+r),e())}))}()}}n(113);var V=n(145),_=n(60),D=n.n(_);var H=function(){return r.a.createElement(V.a,{color:"primary","aria-label":"play"},r.a.createElement(D.a,null))},K=n(61),$=n.n(K);var L=function(){return r.a.createElement(V.a,{color:"primary","aria-label":"pause"},r.a.createElement($.a,null))};var U=function(e){return!1===e.state?r.a.createElement(H,null):r.a.createElement(L,null)},X=n(146);function Y(e){return!0===e.loading?r.a.createElement(X.a,{color:"primary"}):null}function Z(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],l=t[1],c=Object(a.useState)(60),i=Object(o.a)(c,2),u=i[0],m=i[1],h=Object(a.useState)(!1),f=Object(o.a)(h,2),p=f[0],g=f[1];return r.a.createElement("div",null,r.a.createElement(s.a,{variant:"h1",component:"h1"},"Generate"),r.a.createElement(v.a,null,r.a.createElement(d.a,{id:"label",value:"60"},"Tempo"),r.a.createElement(E.a,{labelid:"label",value:u,onChange:function(e){m(e.target.value),function(e){e}(u)},inputProps:{tempo:"tempo"}},r.a.createElement(y.a,{value:60},"60"),r.a.createElement(y.a,{value:80},"80"),r.a.createElement(y.a,{value:100},"100"),r.a.createElement(y.a,{value:120},"120"))),r.a.createElement("div",{className:"play-controller-wrapper",onClick:function(){!0===p&&(g(!1),F.pause()),!1===p&&(g(!0),!1===F.isPlaying()&&I(l),F.resume())}},r.a.createElement(U,{state:p})),r.a.createElement(Y,{loading:n}))}function ee(){return r.a.createElement(s.a,{variant:"h1",component:"h1"},"Train")}function te(){return r.a.createElement("div",{className:"main"},r.a.createElement(g.a,{maxWidth:"sm"},r.a.createElement(u.a,{className:"About",elevation:"5"},r.a.createElement(s.a,{variant:"h5",component:"h5"},"Machine music was made by Andrew Richardson as a sumbission for my final year project."))))}function ne(e){switch(e.view){case 0:return r.a.createElement(Z,null);case 1:return r.a.createElement(ee,null);case 2:return r.a.createElement(te,null);default:return r.a.createElement(Z,null)}}var ae=function(){var e=Object(a.useState)(0),t=Object(o.a)(e,2),n=t[0],l=t[1];return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"Header"},r.a.createElement(m,null)),r.a.createElement("div",{className:"Body"},r.a.createElement(p,{view:n,updateView:l}),r.a.createElement(ne,{view:n})),r.a.createElement("div",{className:"Footer"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},71:function(e,t,n){e.exports=n(115)},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){}},[[71,1,2]]]);
//# sourceMappingURL=main.7b88f098.chunk.js.map